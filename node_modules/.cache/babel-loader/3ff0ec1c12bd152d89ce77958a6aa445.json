{"ast":null,"code":"import _defineProperty from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from\"react\";import{NavLink,useHistory,useParams}from\"react-router-dom\";//jQuery initialization\nimport $ from\"jquery\";//functions\nimport{_t,getCookie,modalLoading,getSystemSettings}from\"../../functions/Functions\";import{useTranslation}from\"react-i18next\";//axios and base url\nimport axios from\"axios\";import{BASE_URL}from\"../../BaseUrl\";//3rd party packages\nimport{Helmet}from\"react-helmet\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import Cookies from\"universal-cookie\";//context consumer\nimport{SettingsContext}from\"../../contexts/Settings\";import{UserContext}from\"../../contexts/User\";import{RestaurantContext}from\"../../contexts/Restaurant\";var cookies=new Cookies();var SetNewPw=function SetNewPw(){var _useTranslation=useTranslation(),t=_useTranslation.t;var history=useHistory();var _useParams=useParams(),token=_useParams.token;//getting context values here\nvar _useContext=useContext(SettingsContext),loading=_useContext.loading,setLoading=_useContext.setLoading,generalSettings=_useContext.generalSettings;//state hooks here\nvar _useState=useState({token:token,email:null,password:\"\",password_confirmation:\"\"}),_useState2=_slicedToArray(_useState,2),credentials=_useState2[0],setCredentials=_useState2[1];useEffect(function(){handleJquery();checkAuth();},[]);//jQuery\nvar handleJquery=function handleJquery(){//obj Image Animation\nvar hoverLayer=$(\"body\");var objImgOne=$(\".fk-global-img__obj\");//Animation Init\nhoverLayer.mousemove(function(e){var valueX=e.pageX*-1/60;var valueY=e.pageY*-1/80;if(objImgOne.length){objImgOne.css({transform:\"translate3d(\"+valueX+\"px,\"+valueY+\"px, 0)\"});}});};//redirect if logged in\nvar checkAuth=function checkAuth(){getCookie()!==undefined&&history.replace(\"/dashboard\");};//set credentials here on input change\nvar handleCredentials=function handleCredentials(e){setCredentials(_objectSpread(_objectSpread({},credentials),{},_defineProperty({},e.target.name,e.target.value)));};//submit credentials to server to send token to email\nvar handleSubmit=function handleSubmit(e){e.preventDefault();setLoading(true);var url=BASE_URL+\"/auth/setNewPassword\";return axios.post(url,credentials).then(function(res){if(res.data===\"noUser\"){toast.error(\"\".concat(_t(t(\"Sorry, email does not match or the link has been expired\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}if(res.data===\"ok\"){toast.success(\"\".concat(_t(t(\"Please login to continue\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});history.push(\"/login\");}setLoading(false);}).catch(function(error){setLoading(false);if(error.response.data.errors.password){error.response.data.errors.password.forEach(function(item){if(item===\"The password confirmation does not match.\"){toast.error(\"\".concat(_t(t(\"Password confirmation does not match\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}if(item===\"The password must be at least 6 characters.\"){toast.error(\"\".concat(_t(t(\"The password must be at least 6 characters\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}});}});};var style={logo:{backgroundColor:\"none\",// generalSettings &&\n// getSystemSettings(generalSettings, \"type_background\"),\nbackgroundImage:generalSettings&&\"url(\".concat(getSystemSettings(generalSettings,\"type_logo\"),\")\")}};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Helmet,null,/*#__PURE__*/React.createElement(\"title\",null,_t(t(\"Set New Password\")))),/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"fk-global-access\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-none d-lg-block\"},/*#__PURE__*/React.createElement(\"div\",{className:\"fk-global-img text-center\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/img/verifiy-img.png\",alt:\"khadyo\",className:\"img-fluid mx-auto fk-global-img__is\"}),/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/img/obj-1.png\",alt:\"khadyo\",className:\"img-fluid fk-global-img__obj fk-global-img__obj-1\"}),/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/img/obj-8.png\",alt:\"khadyo\",className:\"img-fluid fk-global-img__obj fk-global-img__obj-2\"}),/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/img/obj-7.png\",alt:\"khadyo\",className:\"img-fluid fk-global-img__obj fk-global-img__obj-6\"}),/*#__PURE__*/React.createElement(\"img\",{src:\"/assets/img/obj-9.png\",alt:\"khadyo\",className:\"img-fluid fk-global-img__obj fk-global-img__obj-8\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"container my-md-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"fk-brand fk-brand--sr-lg\"},window.location.pathname===\"/\"?/*#__PURE__*/React.createElement(NavLink,{to:{pathname:\"/refresh\",state:\"/\"},exact:true,className:\"t-link w-100\"},/*#__PURE__*/React.createElement(\"span\",{className:\"fk-brand__img fk-brand__img--fk\",style:style.logo})):/*#__PURE__*/React.createElement(NavLink,{to:\"/\",className:\"t-link w-100\"},/*#__PURE__*/React.createElement(\"span\",{className:\"fk-brand__img fk-brand__img--fk\",style:style.logo})))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-8 col-lg-6 col-xl-4 t-mt-50\"},/*#__PURE__*/React.createElement(\"div\",{className:\"fk-global-form\"},loading?/*#__PURE__*/React.createElement(\"div\",{key:\"login-form\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"mt-0 text-capitalize font-weight-bold\"},_t(t(\"Updating password\"))),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},modalLoading(3),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"t-mr-8\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"btn btn-primary sm-text text-uppercase\"},_t(t(\"Please wait\"))))))))):/*#__PURE__*/React.createElement(\"div\",{key:\"loading\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"mt-0 text-capitalize font-weight-bold\"},_t(t(\"Set New Password\"))),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 t-mb-15\"},/*#__PURE__*/React.createElement(\"input\",{onChange:handleCredentials,type:\"email\",name:\"email\",placeholder:\"Enter your email\",value:credentials.email,required:true,className:\"form-control border-0 rounded-1\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 t-mb-15\"},/*#__PURE__*/React.createElement(\"input\",{onChange:handleCredentials,type:\"password\",name:\"password\",placeholder:\"Enter new password\",value:credentials.password,required:true,className:\"form-control border-0 rounded-1\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 t-mb-15\"},/*#__PURE__*/React.createElement(\"input\",{onChange:handleCredentials,type:\"password\",name:\"password_confirmation\",placeholder:\"Confirm password\",value:credentials.password_confirmation,required:true,className:\"form-control border-0 rounded-1\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"t-mr-8\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-success sm-text text-uppercase\"},_t(t(\"Update\"))))))))))))))));};export default SetNewPw;","map":{"version":3,"sources":["/Users/raza/Downloads/khadyo_source_code/client/src/resources/common/SetNewPw.js"],"names":["React","useEffect","useState","useContext","NavLink","useHistory","useParams","$","_t","getCookie","modalLoading","getSystemSettings","useTranslation","axios","BASE_URL","Helmet","toast","Cookies","SettingsContext","UserContext","RestaurantContext","cookies","SetNewPw","t","history","token","loading","setLoading","generalSettings","email","password","password_confirmation","credentials","setCredentials","handleJquery","checkAuth","hoverLayer","objImgOne","mousemove","e","valueX","pageX","valueY","pageY","length","css","transform","undefined","replace","handleCredentials","target","name","value","handleSubmit","preventDefault","url","post","then","res","data","error","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","className","success","push","catch","response","errors","forEach","item","style","logo","backgroundColor","backgroundImage","window","location","pathname","state"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\r\nimport { NavLink, useHistory, useParams } from \"react-router-dom\";\r\n\r\n//jQuery initialization\r\nimport $ from \"jquery\";\r\n\r\n//functions\r\nimport {\r\n  _t,\r\n  getCookie,\r\n  modalLoading,\r\n  getSystemSettings,\r\n} from \"../../functions/Functions\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n//axios and base url\r\nimport axios from \"axios\";\r\nimport { BASE_URL } from \"../../BaseUrl\";\r\n\r\n//3rd party packages\r\nimport { Helmet } from \"react-helmet\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\n//context consumer\r\nimport { SettingsContext } from \"../../contexts/Settings\";\r\nimport { UserContext } from \"../../contexts/User\";\r\nimport { RestaurantContext } from \"../../contexts/Restaurant\";\r\n\r\nconst cookies = new Cookies();\r\n\r\nconst SetNewPw = () => {\r\n  const { t } = useTranslation();\r\n  const history = useHistory();\r\n  const { token } = useParams();\r\n\r\n  //getting context values here\r\n  let { loading, setLoading, generalSettings } = useContext(SettingsContext);\r\n\r\n  //state hooks here\r\n  const [credentials, setCredentials] = useState({\r\n    token: token,\r\n    email: null,\r\n    password: \"\",\r\n    password_confirmation: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    handleJquery();\r\n    checkAuth();\r\n  }, []);\r\n\r\n  //jQuery\r\n  const handleJquery = () => {\r\n    //obj Image Animation\r\n    var hoverLayer = $(\"body\");\r\n    var objImgOne = $(\".fk-global-img__obj\");\r\n\r\n    //Animation Init\r\n    hoverLayer.mousemove(function (e) {\r\n      var valueX = (e.pageX * -1) / 60;\r\n      var valueY = (e.pageY * -1) / 80;\r\n      if (objImgOne.length) {\r\n        objImgOne.css({\r\n          transform: \"translate3d(\" + valueX + \"px,\" + valueY + \"px, 0)\",\r\n        });\r\n      }\r\n    });\r\n  };\r\n\r\n  //redirect if logged in\r\n  const checkAuth = () => {\r\n    getCookie() !== undefined && history.replace(\"/dashboard\");\r\n  };\r\n\r\n  //set credentials here on input change\r\n  const handleCredentials = (e) => {\r\n    setCredentials({\r\n      ...credentials,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  //submit credentials to server to send token to email\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    const url = BASE_URL + \"/auth/setNewPassword\";\r\n    return axios\r\n      .post(url, credentials)\r\n      .then((res) => {\r\n        if (res.data === \"noUser\") {\r\n          toast.error(\r\n            `${_t(\r\n              t(\"Sorry, email does not match or the link has been expired\")\r\n            )}`,\r\n            {\r\n              position: \"bottom-center\",\r\n              autoClose: 10000,\r\n              hideProgressBar: false,\r\n              closeOnClick: true,\r\n              pauseOnHover: true,\r\n              className: \"text-center toast-notification\",\r\n            }\r\n          );\r\n        }\r\n        if (res.data === \"ok\") {\r\n          toast.success(`${_t(t(\"Please login to continue\"))}`, {\r\n            position: \"bottom-center\",\r\n            autoClose: 10000,\r\n            hideProgressBar: false,\r\n            closeOnClick: true,\r\n            pauseOnHover: true,\r\n            className: \"text-center toast-notification\",\r\n          });\r\n          history.push(\"/login\");\r\n        }\r\n        setLoading(false);\r\n      })\r\n      .catch((error) => {\r\n        setLoading(false);\r\n        if (error.response.data.errors.password) {\r\n          error.response.data.errors.password.forEach((item) => {\r\n            if (item === \"The password confirmation does not match.\") {\r\n              toast.error(`${_t(t(\"Password confirmation does not match\"))}`, {\r\n                position: \"bottom-center\",\r\n                autoClose: 10000,\r\n                hideProgressBar: false,\r\n                closeOnClick: true,\r\n                pauseOnHover: true,\r\n                className: \"text-center toast-notification\",\r\n              });\r\n            }\r\n            if (item === \"The password must be at least 6 characters.\") {\r\n              toast.error(\r\n                `${_t(t(\"The password must be at least 6 characters\"))}`,\r\n                {\r\n                  position: \"bottom-center\",\r\n                  autoClose: 10000,\r\n                  hideProgressBar: false,\r\n                  closeOnClick: true,\r\n                  pauseOnHover: true,\r\n                  className: \"text-center toast-notification\",\r\n                }\r\n              );\r\n            }\r\n          });\r\n        }\r\n      });\r\n  };\r\n\r\n  const style = {\r\n    logo: {\r\n      backgroundColor: \"none\",\r\n      // generalSettings &&\r\n      // getSystemSettings(generalSettings, \"type_background\"),\r\n      backgroundImage:\r\n        generalSettings &&\r\n        `url(${getSystemSettings(generalSettings, \"type_logo\")})`,\r\n    },\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{_t(t(\"Set New Password\"))}</title>\r\n      </Helmet>\r\n      <main>\r\n        <div className=\"fk-global-access\">\r\n          <div className=\"d-none d-lg-block\">\r\n            <div className=\"fk-global-img text-center\">\r\n              <img\r\n                src=\"/assets/img/verifiy-img.png\"\r\n                alt=\"khadyo\"\r\n                className=\"img-fluid mx-auto fk-global-img__is\"\r\n              />\r\n              <img\r\n                src=\"/assets/img/obj-1.png\"\r\n                alt=\"khadyo\"\r\n                className=\"img-fluid fk-global-img__obj fk-global-img__obj-1\"\r\n              />\r\n              <img\r\n                src=\"/assets/img/obj-8.png\"\r\n                alt=\"khadyo\"\r\n                className=\"img-fluid fk-global-img__obj fk-global-img__obj-2\"\r\n              />\r\n              <img\r\n                src=\"/assets/img/obj-7.png\"\r\n                alt=\"khadyo\"\r\n                className=\"img-fluid fk-global-img__obj fk-global-img__obj-6\"\r\n              />\r\n              <img\r\n                src=\"/assets/img/obj-9.png\"\r\n                alt=\"khadyo\"\r\n                className=\"img-fluid fk-global-img__obj fk-global-img__obj-8\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"container my-md-auto\">\r\n            <div className=\"row\">\r\n              <div className=\"fk-brand fk-brand--sr-lg\">\r\n                {window.location.pathname === \"/\" ? (\r\n                  <NavLink\r\n                    to={{ pathname: \"/refresh\", state: \"/\" }}\r\n                    exact\r\n                    className=\"t-link w-100\"\r\n                  >\r\n                    <span\r\n                      className=\"fk-brand__img fk-brand__img--fk\"\r\n                      style={style.logo}\r\n                    ></span>\r\n                  </NavLink>\r\n                ) : (\r\n                  <NavLink to=\"/\" className=\"t-link w-100\">\r\n                    <span\r\n                      className=\"fk-brand__img fk-brand__img--fk\"\r\n                      style={style.logo}\r\n                    ></span>\r\n                  </NavLink>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"row\">\r\n              <div className=\"col-md-8 col-lg-6 col-xl-4 t-mt-50\">\r\n                <div className=\"fk-global-form\">\r\n                  {loading ? (\r\n                    <div key=\"login-form\">\r\n                      <h3 className=\"mt-0 text-capitalize font-weight-bold\">\r\n                        {_t(t(\"Updating password\"))}\r\n                      </h3>\r\n                      <form onSubmit={handleSubmit}>\r\n                        <div className=\"row\">\r\n                          {modalLoading(3)}\r\n                          <div className=\"col-12\">\r\n                            <div className=\"d-flex align-items-center\">\r\n                              <div className=\"t-mr-8\">\r\n                                <button\r\n                                  type=\"button\"\r\n                                  className=\"btn btn-primary sm-text text-uppercase\"\r\n                                >\r\n                                  {_t(t(\"Please wait\"))}\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </form>\r\n                    </div>\r\n                  ) : (\r\n                    <div key=\"loading\">\r\n                      <h3 className=\"mt-0 text-capitalize font-weight-bold\">\r\n                        {_t(t(\"Set New Password\"))}\r\n                      </h3>\r\n                      <form onSubmit={handleSubmit}>\r\n                        <div className=\"row\">\r\n                          <div className=\"col-12 t-mb-15\">\r\n                            <input\r\n                              onChange={handleCredentials}\r\n                              type=\"email\"\r\n                              name=\"email\"\r\n                              placeholder=\"Enter your email\"\r\n                              value={credentials.email}\r\n                              required\r\n                              className=\"form-control border-0 rounded-1\"\r\n                            />\r\n                          </div>\r\n\r\n                          <div className=\"col-12 t-mb-15\">\r\n                            <input\r\n                              onChange={handleCredentials}\r\n                              type=\"password\"\r\n                              name=\"password\"\r\n                              placeholder=\"Enter new password\"\r\n                              value={credentials.password}\r\n                              required\r\n                              className=\"form-control border-0 rounded-1\"\r\n                            />\r\n                          </div>\r\n\r\n                          <div className=\"col-12 t-mb-15\">\r\n                            <input\r\n                              onChange={handleCredentials}\r\n                              type=\"password\"\r\n                              name=\"password_confirmation\"\r\n                              placeholder=\"Confirm password\"\r\n                              value={credentials.password_confirmation}\r\n                              required\r\n                              className=\"form-control border-0 rounded-1\"\r\n                            />\r\n                          </div>\r\n\r\n                          <div className=\"col-12\">\r\n                            <div className=\"d-flex align-items-center\">\r\n                              <div className=\"t-mr-8\">\r\n                                <button\r\n                                  type=\"submit\"\r\n                                  className=\"btn btn-success sm-text text-uppercase\"\r\n                                >\r\n                                  {_t(t(\"Update\"))}\r\n                                </button>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </form>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SetNewPw;\r\n"]},"metadata":{},"sourceType":"module"}