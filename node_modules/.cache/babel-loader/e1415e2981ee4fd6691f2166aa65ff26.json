{"ast":null,"code":"import _defineProperty from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState}from\"react\";import{useHistory}from\"react-router-dom\";//axios and base url\nimport axios from\"axios\";import{BASE_URL}from\"../../../../BaseUrl\";//functions\nimport{_t,getCookie,pageLoading,deleteCookie}from\"../../../../functions/Functions\";import{useTranslation}from\"react-i18next\";//3rd party packages\nimport{Helmet}from\"react-helmet\";import\"react-confirm-alert/src/react-confirm-alert.css\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";//importing context consumer here\nimport{UserContext}from\"../../../../contexts/User\";import{SettingsContext}from\"../../../../contexts/Settings\";var UpdateProfile=function UpdateProfile(){//getting context values here\nvar _useContext=useContext(SettingsContext),loading=_useContext.loading,setLoading=_useContext.setLoading,dataPaginating=_useContext.dataPaginating;var _useContext2=useContext(UserContext),authUserInfo=_useContext2.authUserInfo,setAuthUserInfo=_useContext2.setAuthUserInfo;var history=useHistory();var _useTranslation=useTranslation(),t=_useTranslation.t;//new adminStaff\nvar _useState=useState({phn_no:\"\",password:\"\",password_confirmation:\"\",image:null,edit:false,uploading:false}),_useState2=_slicedToArray(_useState,2),newAdminStaff=_useState2[0],setAdminStaff=_useState2[1];//useEffect\nuseEffect(function(){setLoading(true);if(authUserInfo&&authUserInfo.details){setAdminStaff(_objectSpread(_objectSpread({},newAdminStaff),{},{phn_no:authUserInfo.details.phn_no}));}setTimeout(function(){setLoading(false);},500);},[authUserInfo]);//set image hook\nvar handleAdminStaffImage=function handleAdminStaffImage(e){setAdminStaff(_objectSpread(_objectSpread({},newAdminStaff),{},_defineProperty({},e.target.name,e.target.files[0])));};//set name, phn no hook\nvar handleSetNewAdminStaff=function handleSetNewAdminStaff(e){setAdminStaff(_objectSpread(_objectSpread({},newAdminStaff),{},_defineProperty({},e.target.name,e.target.value)));};//set name, phn no hook\nvar handleUpdateAdminStaff=function handleUpdateAdminStaff(e){e.preventDefault();var adminStaffUrl=BASE_URL+\"/settings/update-profile\";setLoading(true);var formData=new FormData();formData.append(\"phn_no\",newAdminStaff.phn_no);formData.append(\"image\",newAdminStaff.image);return axios.post(adminStaffUrl,formData,{headers:{Authorization:\"Bearer \".concat(getCookie())}}).then(function(){setLoading(false);setAuthUserInfo(_objectSpread(_objectSpread({},authUserInfo),{},{details:_objectSpread(_objectSpread({},authUserInfo.details),{},{phn_no:newAdminStaff.phn_no})}));setAdminStaff(_objectSpread(_objectSpread({},newAdminStaff),{},{password:\"\",password_confirmation:\"\",image:null}));toast.success(\"\".concat(_t(t(\"Profile updated\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}).catch(function(error){setLoading(false);if(error&&error.response.data.errors){if(error.response.data.errors.phn_no){error.response.data.errors.phn_no.forEach(function(item){if(item===\"An user exists with this phone number\"){toast.error(\"\".concat(_t(t(\"An user exists with this phone number\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}});}if(error.response.data.errors.image){error.response.data.errors.image.forEach(function(item){if(item===\"Please select a valid image file\"){toast.error(\"\".concat(_t(t(\"Please select a valid image file\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}if(item===\"Please select a file less than 5MB\"){toast.error(\"\".concat(_t(t(\"Please select a file less than 5MB\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}});}}});};//set name, phn no hook\nvar handleUpdateAdminStaffPassword=function handleUpdateAdminStaffPassword(e){e.preventDefault();var adminStaffUrl=BASE_URL+\"/settings/update-profile\";setLoading(true);var formData=new FormData();formData.append(\"password\",newAdminStaff.password);formData.append(\"password_confirmation\",newAdminStaff.password_confirmation);return axios.post(adminStaffUrl,formData,{headers:{Authorization:\"Bearer \".concat(getCookie())}}).then(function(){setLoading(false);handleLogout();toast.success(\"\".concat(_t(t(\"Profile updated, please login to continue\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}).catch(function(error){setLoading(false);if(error&&error.response.data.errors){if(error.response.data.errors.password){error.response.data.errors.password.forEach(function(item){if(item===\"Password confirmation does not match\"){toast.error(\"\".concat(_t(t(\"Password confirmation does not match\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}});}}});};//logout\nvar handleLogout=function handleLogout(){deleteCookie();};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Helmet,null,/*#__PURE__*/React.createElement(\"title\",null,_t(t(\"Update Password\")))),/*#__PURE__*/React.createElement(\"main\",{id:\"main\",\"data-simplebar\":true},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row t-mt-10 gx-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 t-mb-30 mb-lg-0\"},loading===true?pageLoading():/*#__PURE__*/React.createElement(\"div\",{className:\"t-bg-white \"},/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(dataPaginating&&\"loading\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"row gx-2 align-items-center t-pt-15 t-pb-15 t-pl-15 t-pr-15 t-shadow\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"t-list fk-breadcrumb\"},/*#__PURE__*/React.createElement(\"li\",{className:\"fk-breadcrumb__list\"},/*#__PURE__*/React.createElement(\"span\",{className:\"t-link fk-breadcrumb__link text-capitalize\"},_t(t(\"Update Password\"))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"fk-scroll--order-history profile-update-full\",\"data-simplebar\":true},/*#__PURE__*/React.createElement(\"div\",{className:\"mt-5 t-pt-30 t-pl-15  t-pr-15\"},/*#__PURE__*/React.createElement(\"div\",{className:\"\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card col-8 offset-2 mb-3 mb-md-0 p-5\"},/*#__PURE__*/React.createElement(\"div\",{key:\"fragment-permission-2\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleUpdateAdminStaffPassword},/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"password\",className:\"form-label\"},_t(t(\"Password\"))),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",id:\"password\",name:\"password\",placeholder:_t(t(\"Password\")),value:newAdminStaff.password||\"\",onChange:handleSetNewAdminStaff,required:true,autoComplete:\"off\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"password_confirmation\",className:\"form-label\"},_t(t(\"Confirm Password\"))),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control\",id:\"password_confirmation\",name:\"password_confirmation\",placeholder:_t(t(\"Confirm Password\")),value:newAdminStaff.password_confirmation||\"\",required:true,onChange:handleSetNewAdminStaff,autoComplete:\"off\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-4\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary xsm-text text-uppercase px-5 py-2 mb-2 mb-md-0\"},_t(t(\"Update Password\"))))))))))))))));};export default UpdateProfile;","map":{"version":3,"sources":["/Users/raza/Downloads/khadyo_source_code/client/src/resources/restaurant/auth/profile/UpdateProfile.js"],"names":["React","useEffect","useContext","useState","useHistory","axios","BASE_URL","_t","getCookie","pageLoading","deleteCookie","useTranslation","Helmet","toast","UserContext","SettingsContext","UpdateProfile","loading","setLoading","dataPaginating","authUserInfo","setAuthUserInfo","history","t","phn_no","password","password_confirmation","image","edit","uploading","newAdminStaff","setAdminStaff","details","setTimeout","handleAdminStaffImage","e","target","name","files","handleSetNewAdminStaff","value","handleUpdateAdminStaff","preventDefault","adminStaffUrl","formData","FormData","append","post","headers","Authorization","then","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","className","catch","error","response","data","errors","forEach","item","handleUpdateAdminStaffPassword","handleLogout"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\n//axios and base url\r\nimport axios from \"axios\";\r\nimport { BASE_URL } from \"../../../../BaseUrl\";\r\n\r\n//functions\r\nimport {\r\n  _t,\r\n  getCookie,\r\n  pageLoading,\r\n  deleteCookie,\r\n} from \"../../../../functions/Functions\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n//3rd party packages\r\nimport { Helmet } from \"react-helmet\";\r\nimport \"react-confirm-alert/src/react-confirm-alert.css\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\n//importing context consumer here\r\nimport { UserContext } from \"../../../../contexts/User\";\r\nimport { SettingsContext } from \"../../../../contexts/Settings\";\r\n\r\nconst UpdateProfile = () => {\r\n  //getting context values here\r\n  const {\r\n    //common\r\n    loading,\r\n    setLoading,\r\n    dataPaginating,\r\n  } = useContext(SettingsContext);\r\n\r\n  const { authUserInfo, setAuthUserInfo } = useContext(UserContext);\r\n\r\n  const history = useHistory();\r\n  const { t } = useTranslation();\r\n\r\n  //new adminStaff\r\n  let [newAdminStaff, setAdminStaff] = useState({\r\n    phn_no: \"\",\r\n    password: \"\",\r\n    password_confirmation: \"\",\r\n    image: null,\r\n    edit: false,\r\n    uploading: false,\r\n  });\r\n\r\n  //useEffect\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    if (authUserInfo && authUserInfo.details) {\r\n      setAdminStaff({\r\n        ...newAdminStaff,\r\n        phn_no: authUserInfo.details.phn_no,\r\n      });\r\n    }\r\n    setTimeout(() => {\r\n      setLoading(false);\r\n    }, 500);\r\n  }, [authUserInfo]);\r\n\r\n  //set image hook\r\n  const handleAdminStaffImage = (e) => {\r\n    setAdminStaff({\r\n      ...newAdminStaff,\r\n      [e.target.name]: e.target.files[0],\r\n    });\r\n  };\r\n\r\n  //set name, phn no hook\r\n  const handleSetNewAdminStaff = (e) => {\r\n    setAdminStaff({ ...newAdminStaff, [e.target.name]: e.target.value });\r\n  };\r\n  //set name, phn no hook\r\n  const handleUpdateAdminStaff = (e) => {\r\n    e.preventDefault();\r\n    const adminStaffUrl = BASE_URL + `/settings/update-profile`;\r\n    setLoading(true);\r\n\r\n    let formData = new FormData();\r\n    formData.append(\"phn_no\", newAdminStaff.phn_no);\r\n    formData.append(\"image\", newAdminStaff.image);\r\n\r\n    return axios\r\n      .post(adminStaffUrl, formData, {\r\n        headers: { Authorization: `Bearer ${getCookie()}` },\r\n      })\r\n      .then(() => {\r\n        setLoading(false);\r\n        setAuthUserInfo({\r\n          ...authUserInfo,\r\n          details: { ...authUserInfo.details, phn_no: newAdminStaff.phn_no },\r\n        });\r\n        setAdminStaff({\r\n          ...newAdminStaff,\r\n          password: \"\",\r\n          password_confirmation: \"\",\r\n          image: null,\r\n        });\r\n        toast.success(`${_t(t(\"Profile updated\"))}`, {\r\n          position: \"bottom-center\",\r\n          autoClose: 10000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          className: \"text-center toast-notification\",\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        setLoading(false);\r\n        if (error && error.response.data.errors) {\r\n          if (error.response.data.errors.phn_no) {\r\n            error.response.data.errors.phn_no.forEach((item) => {\r\n              if (item === \"An user exists with this phone number\") {\r\n                toast.error(\r\n                  `${_t(t(\"An user exists with this phone number\"))}`,\r\n                  {\r\n                    position: \"bottom-center\",\r\n                    autoClose: 10000,\r\n                    hideProgressBar: false,\r\n                    closeOnClick: true,\r\n                    pauseOnHover: true,\r\n                    className: \"text-center toast-notification\",\r\n                  }\r\n                );\r\n              }\r\n            });\r\n          }\r\n\r\n          if (error.response.data.errors.image) {\r\n            error.response.data.errors.image.forEach((item) => {\r\n              if (item === \"Please select a valid image file\") {\r\n                toast.error(`${_t(t(\"Please select a valid image file\"))}`, {\r\n                  position: \"bottom-center\",\r\n                  autoClose: 10000,\r\n                  hideProgressBar: false,\r\n                  closeOnClick: true,\r\n                  pauseOnHover: true,\r\n                  className: \"text-center toast-notification\",\r\n                });\r\n              }\r\n              if (item === \"Please select a file less than 5MB\") {\r\n                toast.error(`${_t(t(\"Please select a file less than 5MB\"))}`, {\r\n                  position: \"bottom-center\",\r\n                  autoClose: 10000,\r\n                  hideProgressBar: false,\r\n                  closeOnClick: true,\r\n                  pauseOnHover: true,\r\n                  className: \"text-center toast-notification\",\r\n                });\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  //set name, phn no hook\r\n  const handleUpdateAdminStaffPassword = (e) => {\r\n    e.preventDefault();\r\n    const adminStaffUrl = BASE_URL + `/settings/update-profile`;\r\n    setLoading(true);\r\n\r\n    let formData = new FormData();\r\n    formData.append(\"password\", newAdminStaff.password);\r\n    formData.append(\r\n      \"password_confirmation\",\r\n      newAdminStaff.password_confirmation\r\n    );\r\n    return axios\r\n      .post(adminStaffUrl, formData, {\r\n        headers: { Authorization: `Bearer ${getCookie()}` },\r\n      })\r\n      .then(() => {\r\n        setLoading(false);\r\n        handleLogout();\r\n        toast.success(`${_t(t(\"Profile updated, please login to continue\"))}`, {\r\n          position: \"bottom-center\",\r\n          autoClose: 10000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          className: \"text-center toast-notification\",\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        setLoading(false);\r\n        if (error && error.response.data.errors) {\r\n          if (error.response.data.errors.password) {\r\n            error.response.data.errors.password.forEach((item) => {\r\n              if (item === \"Password confirmation does not match\") {\r\n                toast.error(\r\n                  `${_t(t(\"Password confirmation does not match\"))}`,\r\n                  {\r\n                    position: \"bottom-center\",\r\n                    autoClose: 10000,\r\n                    hideProgressBar: false,\r\n                    closeOnClick: true,\r\n                    pauseOnHover: true,\r\n                    className: \"text-center toast-notification\",\r\n                  }\r\n                );\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n  };\r\n\r\n  //logout\r\n  const handleLogout = () => {\r\n    deleteCookie();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{_t(t(\"Update Password\"))}</title>\r\n      </Helmet>\r\n      <main id=\"main\" data-simplebar>\r\n        <div className=\"container\">\r\n          <div className=\"row t-mt-10 gx-2\">\r\n            <div className=\"col-12 t-mb-30 mb-lg-0\">\r\n              {loading === true ? (\r\n                pageLoading()\r\n              ) : (\r\n                <div className=\"t-bg-white \">\r\n                  {/* next page data spin loading */}\r\n                  <div className={`${dataPaginating && \"loading\"}`}></div>\r\n                  {/* spin loading ends */}\r\n                  <div className=\"row gx-2 align-items-center t-pt-15 t-pb-15 t-pl-15 t-pr-15 t-shadow\">\r\n                    <div className=\"col-12\">\r\n                      <ul className=\"t-list fk-breadcrumb\">\r\n                        <li className=\"fk-breadcrumb__list\">\r\n                          <span className=\"t-link fk-breadcrumb__link text-capitalize\">\r\n                            {_t(t(\"Update Password\"))}\r\n                          </span>\r\n                        </li>\r\n                      </ul>\r\n                    </div>\r\n                  </div>\r\n                  <div\r\n                    className=\"fk-scroll--order-history profile-update-full\"\r\n                    data-simplebar\r\n                  >\r\n                    <div className=\"mt-5 t-pt-30 t-pl-15  t-pr-15\">\r\n                      <div className=\"\">\r\n                        <div className=\"card col-8 offset-2 mb-3 mb-md-0 p-5\">\r\n                          <div key=\"fragment-permission-2\">\r\n                            <form onSubmit={handleUpdateAdminStaffPassword}>\r\n                              <div className=\"mt-3\">\r\n                                <label\r\n                                  htmlFor=\"password\"\r\n                                  className=\"form-label\"\r\n                                >\r\n                                  {_t(t(\"Password\"))}\r\n                                </label>\r\n                                <input\r\n                                  type=\"password\"\r\n                                  className=\"form-control\"\r\n                                  id=\"password\"\r\n                                  name=\"password\"\r\n                                  placeholder={_t(t(\"Password\"))}\r\n                                  value={newAdminStaff.password || \"\"}\r\n                                  onChange={handleSetNewAdminStaff}\r\n                                  required\r\n                                  autoComplete=\"off\"\r\n                                />\r\n                              </div>\r\n\r\n                              <div className=\"mt-3\">\r\n                                <label\r\n                                  htmlFor=\"password_confirmation\"\r\n                                  className=\"form-label\"\r\n                                >\r\n                                  {_t(t(\"Confirm Password\"))}\r\n                                </label>\r\n                                <input\r\n                                  type=\"password\"\r\n                                  className=\"form-control\"\r\n                                  id=\"password_confirmation\"\r\n                                  name=\"password_confirmation\"\r\n                                  placeholder={_t(t(\"Confirm Password\"))}\r\n                                  value={\r\n                                    newAdminStaff.password_confirmation || \"\"\r\n                                  }\r\n                                  required\r\n                                  onChange={handleSetNewAdminStaff}\r\n                                  autoComplete=\"off\"\r\n                                />\r\n                              </div>\r\n\r\n                              <div className=\"mt-4\">\r\n                                <button\r\n                                  type=\"submit\"\r\n                                  className=\"btn btn-primary xsm-text text-uppercase px-5 py-2 mb-2 mb-md-0\"\r\n                                >\r\n                                  {_t(t(\"Update Password\"))}\r\n                                </button>\r\n                              </div>\r\n                            </form>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default UpdateProfile;\r\n"]},"metadata":{},"sourceType":"module"}