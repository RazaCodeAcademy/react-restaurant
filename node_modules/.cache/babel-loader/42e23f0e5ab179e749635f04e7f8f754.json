{"ast":null,"code":"import _objectSpread from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/raza/Downloads/khadyo_source_code/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useContext,useState}from\"react\";//axios and base url\nimport axios from\"axios\";import{BASE_URL}from\"../../../../BaseUrl\";//functions\nimport{_t,getCookie,pageLoading,paginationLoading,pagination}from\"../../../../functions/Functions\";import{useTranslation}from\"react-i18next\";//3rd party packages\nimport{Helmet}from\"react-helmet\";import\"react-confirm-alert/src/react-confirm-alert.css\";import{toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";//importing context consumer here\nimport{RestaurantContext}from\"../../../../contexts/Restaurant\";import{FoodContext}from\"../../../../contexts/Food\";import{NavLink,useParams}from\"react-router-dom\";var OpeningClosingStockIngredientReport=function OpeningClosingStockIngredientReport(){var _useContext=useContext(RestaurantContext),workPeriodList=_useContext.workPeriodList,setPaginatedWorkPeriod=_useContext.setPaginatedWorkPeriod,dataPaginating=_useContext.dataPaginating;var _useContext2=useContext(FoodContext),getIngredientStock=_useContext2.getIngredientStock,loading=_useContext2.loading,setLoading=_useContext2.setLoading,items=_useContext2.items,setItems=_useContext2.setItems,theGroups=_useContext2.theGroups;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useParams=useParams(),started_at=_useParams.started_at;//new unit\nvar _useState=useState({user_type:null,branch_id:null,uploading:false}),_useState2=_slicedToArray(_useState,2),newWorkPeriod=_useState2[0],setNewWorkPeriod=_useState2[1];//search result\nvar _useState3=useState({list:null,searched:false}),_useState4=_slicedToArray(_useState3,2),searchedWorkPeriod=_useState4[0],setSearchedWorkPeriod=_useState4[1];//useEffect == componentDidMount\nuseEffect(function(){getIngredientStock(started_at);},[]);//update stock\nvar handleUpdate=function handleUpdate(){setLoading(true);var url=BASE_URL+\"/settings/update-closing-items\";var formData={items:items};return axios.post(url,formData,{headers:{Authorization:\"Bearer \".concat(getCookie())}}).then(function(res){getIngredientStock(started_at);setLoading(false);toast.success(\"\".concat(_t(t(\"Closing stock has been updated\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});}).catch(function(){setLoading(false);toast.error(\"\".concat(_t(t(\"Please try again\"))),{position:\"bottom-center\",autoClose:10000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,className:\"text-center toast-notification\"});});};//maximum\nvar hadnleMax=function hadnleMax(item){var temp=parseFloat(item.opening_stock)+parseFloat(item.addition_to_opening!==null?item.addition_to_opening:0)-parseFloat(item.subtraction_from_opening!==null?item.subtraction_from_opening:0);return JSON.stringify(temp);};var handleUsage=function handleUsage(item){var usage=0;var opening=0;var closing=0;var additon=0;var subtraction=0;if(item.opening_stock!==null&&item.closing_stock!==null){opening=parseFloat(item.opening_stock);closing=parseFloat(item.closing_stock);}if(item.addition_to_opening!==null){additon=parseFloat(item.addition_to_opening);}if(item.subtraction_from_opening!==null){subtraction=parseFloat(item.subtraction_from_opening);}usage=opening+additon-subtraction-closing;return usage;};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Helmet,null,/*#__PURE__*/React.createElement(\"title\",null,_t(t(\"Ingredient Stock\")))),/*#__PURE__*/React.createElement(\"main\",{id:\"main\",\"data-simplebar\":true},/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row t-mt-10 gx-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 t-mb-30 mb-lg-0\"},newWorkPeriod.uploading===true||loading===true?pageLoading():/*#__PURE__*/React.createElement(\"div\",{className:\"t-bg-white \"},/*#__PURE__*/React.createElement(\"div\",{className:\"\".concat(dataPaginating&&\"loading\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"row gx-2 align-items-center t-pt-15 t-pb-15 t-pl-15 t-pr-15 t-shadow\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 t-mb-15\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"t-list fk-breadcrumb\"},/*#__PURE__*/React.createElement(\"li\",{className:\"fk-breadcrumb__list\"},/*#__PURE__*/React.createElement(\"span\",{className:\"t-link fk-breadcrumb__link text-capitalize\"},_t(t(\"Ingredient Stock\")))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 col-lg-5\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 col-lg-7 t-mb-15 mb-md-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row gx-2 align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 col-md-5 ml-auto mt-2 mt-md-0\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"t-list fk-sort align-items-center justify-content-center\"},/*#__PURE__*/React.createElement(\"li\",{className:\"fk-sort__list mb-0 flex-grow-1\"},/*#__PURE__*/React.createElement(NavLink,{to:\"/dashboard/ingredient-stock\",className:\"w-100 btn alert-danger sm-text text-uppercase\"},_t(t(\"Go Back\"))))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"fk-scroll--order-history\",\"data-simplebar\":true},/*#__PURE__*/React.createElement(\"div\",{className:\"t-pl-15 t-pr-15\"},/*#__PURE__*/React.createElement(\"form\",{className:\"table-responsive\",onSubmit:handleUpdate},/*#__PURE__*/React.createElement(\"table\",{className:\"table table-bordered table-hover min-table-height mt-4\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"align-middle\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"S/L\"))),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"Name\"))),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"Opening Stock\"))),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"Addition\"))),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"Subtraction\"))),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"Closing Stock\"))),/*#__PURE__*/React.createElement(\"th\",{scope:\"col\",className:\"sm-text align-middle text-center border-1 border\"},_t(t(\"Usage\"))))),/*#__PURE__*/React.createElement(\"tbody\",{className:\"align-middle\"},!searchedWorkPeriod.searched?[items&&theGroups&&[items.length===0?/*#__PURE__*/React.createElement(\"tr\",{className:\"align-middle\"},/*#__PURE__*/React.createElement(\"td\",{scope:\"row\",colSpan:\"8\",className:\"xsm-text align-middle text-center\"},_t(t(\"No data available\")))):theGroups.map(function(grpItem,grpItemIndex){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"tr\",{className:\"align-middle alert-success\"},/*#__PURE__*/React.createElement(\"td\",{scope:\"row\",colSpan:\"8\",className:\"xsm-text align-middle text-left ml-5 text-uppercase\"},grpItem.name)),items.map(function(item,index){if(parseInt(item.ingredient_group_id)===grpItem.id){return/*#__PURE__*/React.createElement(\"tr\",{className:\"align-middle\",key:index},/*#__PURE__*/React.createElement(\"th\",{scope:\"row\",className:\"xsm-text text-capitalize align-middle text-center\"},index+1),/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center text-secondary\"},item.ingredient_name+\" / \"+item.ingredient_unit),/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center\"},item.opening_stock),/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center\"},item.addition_to_opening===null?0:item.addition_to_opening),/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center\"},item.subtraction_from_opening===null?0:item.subtraction_from_opening),/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center\"},item.closing_stock||\"-\"),item.closing_stock!==null?/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center\"},handleUsage(item)):/*#__PURE__*/React.createElement(\"td\",{className:\"xsm-text align-middle text-center\"},\"-\"));}else{return false;}}));})]]:\"\")))))),newWorkPeriod.uploading===true||loading===true?paginationLoading():[// logic === !searched\n!searchedWorkPeriod.searched?/*#__PURE__*/React.createElement(\"div\",{key:\"fragment4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"t-bg-white mt-1 t-pt-5 t-pb-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row align-items-center t-pl-15 t-pr-15\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-7 t-mb-15 mb-md-0\"},pagination(workPeriodList,setPaginatedWorkPeriod)),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"t-list d-flex justify-content-md-end align-items-center\"},/*#__PURE__*/React.createElement(\"li\",{className:\"t-list__item\"},/*#__PURE__*/React.createElement(\"span\",{className:\"d-inline-block sm-text\"}))))))):/*#__PURE__*/ // if searched\nReact.createElement(\"div\",{className:\"t-bg-white mt-1 t-pt-5 t-pb-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row align-items-center t-pl-15 t-pr-15\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-7 t-mb-15 mb-md-0\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"t-list d-flex\"},/*#__PURE__*/React.createElement(\"li\",{className:\"t-list__item no-pagination-style\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary btn-sm\",onClick:function onClick(){return setSearchedWorkPeriod(_objectSpread(_objectSpread({},searchedWorkPeriod),{},{searched:false}));}},_t(t(\"Clear Search\")))))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-5\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"t-list d-flex justify-content-md-end align-items-center\"},/*#__PURE__*/React.createElement(\"li\",{className:\"t-list__item\"},/*#__PURE__*/React.createElement(\"span\",{className:\"d-inline-block sm-text\"}))))))])))));};export default OpeningClosingStockIngredientReport;","map":{"version":3,"sources":["/Users/raza/Downloads/khadyo_source_code/client/src/resources/restaurant/auth/reports/OpeningClosingStockIngredientReport.js"],"names":["React","useEffect","useContext","useState","axios","BASE_URL","_t","getCookie","pageLoading","paginationLoading","pagination","useTranslation","Helmet","toast","RestaurantContext","FoodContext","NavLink","useParams","OpeningClosingStockIngredientReport","workPeriodList","setPaginatedWorkPeriod","dataPaginating","getIngredientStock","loading","setLoading","items","setItems","theGroups","t","started_at","user_type","branch_id","uploading","newWorkPeriod","setNewWorkPeriod","list","searched","searchedWorkPeriod","setSearchedWorkPeriod","handleUpdate","url","formData","post","headers","Authorization","then","res","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","className","catch","error","hadnleMax","item","temp","parseFloat","opening_stock","addition_to_opening","subtraction_from_opening","JSON","stringify","handleUsage","usage","opening","closing","additon","subtraction","closing_stock","length","map","grpItem","grpItemIndex","name","index","parseInt","ingredient_group_id","id","ingredient_name","ingredient_unit"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from \"react\";\r\n\r\n//axios and base url\r\nimport axios from \"axios\";\r\nimport { BASE_URL } from \"../../../../BaseUrl\";\r\n\r\n//functions\r\nimport {\r\n  _t,\r\n  getCookie,\r\n  pageLoading,\r\n  paginationLoading,\r\n  pagination,\r\n} from \"../../../../functions/Functions\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n//3rd party packages\r\nimport { Helmet } from \"react-helmet\";\r\nimport \"react-confirm-alert/src/react-confirm-alert.css\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\n//importing context consumer here\r\nimport { RestaurantContext } from \"../../../../contexts/Restaurant\";\r\nimport { FoodContext } from \"../../../../contexts/Food\";\r\nimport { NavLink, useParams } from \"react-router-dom\";\r\nconst OpeningClosingStockIngredientReport = () => {\r\n  const {\r\n    //work period\r\n    workPeriodList,\r\n    setPaginatedWorkPeriod,\r\n    // workPeriodForSearch,\r\n    dataPaginating,\r\n  } = useContext(RestaurantContext);\r\n\r\n  const {\r\n    getIngredientStock,\r\n    loading,\r\n    setLoading,\r\n    items,\r\n    setItems,\r\n    theGroups,\r\n  } = useContext(FoodContext);\r\n\r\n  const { t } = useTranslation();\r\n  const { started_at } = useParams();\r\n\r\n  //new unit\r\n  let [newWorkPeriod, setNewWorkPeriod] = useState({\r\n    user_type: null,\r\n    branch_id: null,\r\n    uploading: false,\r\n  });\r\n\r\n  //search result\r\n  let [searchedWorkPeriod, setSearchedWorkPeriod] = useState({\r\n    list: null,\r\n    searched: false,\r\n  });\r\n\r\n  //useEffect == componentDidMount\r\n  useEffect(() => {\r\n    getIngredientStock(started_at);\r\n  }, []);\r\n\r\n  //update stock\r\n  const handleUpdate = () => {\r\n    setLoading(true);\r\n    const url = BASE_URL + `/settings/update-closing-items`;\r\n    let formData = {\r\n      items: items,\r\n    };\r\n    return axios\r\n      .post(url, formData, {\r\n        headers: { Authorization: `Bearer ${getCookie()}` },\r\n      })\r\n      .then((res) => {\r\n        getIngredientStock(started_at);\r\n        setLoading(false);\r\n        toast.success(`${_t(t(\"Closing stock has been updated\"))}`, {\r\n          position: \"bottom-center\",\r\n          autoClose: 10000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          className: \"text-center toast-notification\",\r\n        });\r\n      })\r\n      .catch(() => {\r\n        setLoading(false);\r\n        toast.error(`${_t(t(\"Please try again\"))}`, {\r\n          position: \"bottom-center\",\r\n          autoClose: 10000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          className: \"text-center toast-notification\",\r\n        });\r\n      });\r\n  };\r\n\r\n  //maximum\r\n  const hadnleMax = (item) => {\r\n    let temp =\r\n      parseFloat(item.opening_stock) +\r\n      parseFloat(\r\n        item.addition_to_opening !== null ? item.addition_to_opening : 0\r\n      ) -\r\n      parseFloat(\r\n        item.subtraction_from_opening !== null\r\n          ? item.subtraction_from_opening\r\n          : 0\r\n      );\r\n    return JSON.stringify(temp);\r\n  };\r\n\r\n  const handleUsage = (item) => {\r\n    let usage = 0;\r\n    let opening = 0;\r\n    let closing = 0;\r\n    let additon = 0;\r\n    let subtraction = 0;\r\n    if (item.opening_stock !== null && item.closing_stock !== null) {\r\n      opening = parseFloat(item.opening_stock);\r\n      closing = parseFloat(item.closing_stock);\r\n    }\r\n    if (item.addition_to_opening !== null) {\r\n      additon = parseFloat(item.addition_to_opening);\r\n    }\r\n    if (item.subtraction_from_opening !== null) {\r\n      subtraction = parseFloat(item.subtraction_from_opening);\r\n    }\r\n\r\n    usage = opening + additon - subtraction - closing;\r\n    return usage;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{_t(t(\"Ingredient Stock\"))}</title>\r\n      </Helmet>\r\n      <main id=\"main\" data-simplebar>\r\n        <div className=\"container\">\r\n          <div className=\"row t-mt-10 gx-2\">\r\n            <div className=\"col-12 t-mb-30 mb-lg-0\">\r\n              {newWorkPeriod.uploading === true || loading === true ? (\r\n                pageLoading()\r\n              ) : (\r\n                <div className=\"t-bg-white \">\r\n                  {/* next page data spin loading */}\r\n                  <div className={`${dataPaginating && \"loading\"}`}></div>\r\n                  {/* spin loading ends */}\r\n                  <div className=\"row gx-2 align-items-center t-pt-15 t-pb-15 t-pl-15 t-pr-15 t-shadow\">\r\n                    <div className=\"col-12 t-mb-15\">\r\n                      <ul className=\"t-list fk-breadcrumb\">\r\n                        <li className=\"fk-breadcrumb__list\">\r\n                          <span className=\"t-link fk-breadcrumb__link text-capitalize\">\r\n                            {_t(t(\"Ingredient Stock\"))}\r\n                          </span>\r\n                        </li>\r\n                      </ul>\r\n                    </div>\r\n                    <div className=\"col-md-6 col-lg-5\"></div>\r\n                    <div className=\"col-md-6 col-lg-7 t-mb-15 mb-md-0\">\r\n                      <div className=\"row gx-2 align-items-center\">\r\n                        <div className=\"col-12 col-md-5 ml-auto mt-2 mt-md-0\">\r\n                          <ul className=\"t-list fk-sort align-items-center justify-content-center\">\r\n                            <li className=\"fk-sort__list mb-0 flex-grow-1\">\r\n                              <NavLink\r\n                                to=\"/dashboard/ingredient-stock\"\r\n                                className=\"w-100 btn alert-danger sm-text text-uppercase\"\r\n                              >\r\n                                {_t(t(\"Go Back\"))}\r\n                              </NavLink>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"fk-scroll--order-history\" data-simplebar>\r\n                    <div className=\"t-pl-15 t-pr-15\">\r\n                      <form\r\n                        className=\"table-responsive\"\r\n                        onSubmit={handleUpdate}\r\n                      >\r\n                        <table className=\"table table-bordered table-hover min-table-height mt-4\">\r\n                          <thead className=\"align-middle\">\r\n                            <tr>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"S/L\"))}\r\n                              </th>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"Name\"))}\r\n                              </th>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"Opening Stock\"))}\r\n                              </th>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"Addition\"))}\r\n                              </th>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"Subtraction\"))}\r\n                              </th>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"Closing Stock\"))}\r\n                              </th>\r\n                              <th\r\n                                scope=\"col\"\r\n                                className=\"sm-text align-middle text-center border-1 border\"\r\n                              >\r\n                                {_t(t(\"Usage\"))}\r\n                              </th>\r\n                            </tr>\r\n                          </thead>\r\n                          <tbody className=\"align-middle\">\r\n                            {!searchedWorkPeriod.searched\r\n                              ? [\r\n                                items &&\r\n                                theGroups && [\r\n                                  items.length === 0 ? (\r\n                                    <tr className=\"align-middle\">\r\n                                      <td\r\n                                        scope=\"row\"\r\n                                        colSpan=\"8\"\r\n                                        className=\"xsm-text align-middle text-center\"\r\n                                      >\r\n                                        {_t(t(\"No data available\"))}\r\n                                      </td>\r\n                                    </tr>\r\n                                  ) : (\r\n                                    theGroups.map(\r\n                                      (grpItem, grpItemIndex) => {\r\n                                        return (\r\n                                          <>\r\n                                            <tr className=\"align-middle alert-success\">\r\n                                              <td\r\n                                                scope=\"row\"\r\n                                                colSpan=\"8\"\r\n                                                className=\"xsm-text align-middle text-left ml-5 text-uppercase\"\r\n                                              >\r\n                                                {grpItem.name}\r\n                                              </td>\r\n                                            </tr>\r\n                                            {items.map((item, index) => {\r\n                                              if (\r\n                                                parseInt(\r\n                                                  item.ingredient_group_id\r\n                                                ) === grpItem.id\r\n                                              ) {\r\n                                                return (\r\n                                                  <tr\r\n                                                    className=\"align-middle\"\r\n                                                    key={index}\r\n                                                  >\r\n                                                    <th\r\n                                                      scope=\"row\"\r\n                                                      className=\"xsm-text text-capitalize align-middle text-center\"\r\n                                                    >\r\n                                                      {index + 1}\r\n                                                    </th>\r\n\r\n                                                    <td className=\"xsm-text align-middle text-center text-secondary\">\r\n                                                      {item.ingredient_name +\r\n                                                        \" / \" +\r\n                                                        item.ingredient_unit}\r\n                                                    </td>\r\n\r\n                                                    <td className=\"xsm-text align-middle text-center\">\r\n                                                      {item.opening_stock}\r\n                                                    </td>\r\n\r\n                                                    <td className=\"xsm-text align-middle text-center\">\r\n                                                      {item.addition_to_opening ===\r\n                                                        null\r\n                                                        ? 0\r\n                                                        : item.addition_to_opening}\r\n                                                    </td>\r\n\r\n                                                    <td className=\"xsm-text align-middle text-center\">\r\n                                                      {item.subtraction_from_opening ===\r\n                                                        null\r\n                                                        ? 0\r\n                                                        : item.subtraction_from_opening}\r\n                                                    </td>\r\n\r\n                                                    <td className=\"xsm-text align-middle text-center\">\r\n                                                      {item.closing_stock ||\r\n                                                        \"-\"}\r\n                                                    </td>\r\n\r\n                                                    {item.closing_stock !==\r\n                                                      null ? (\r\n                                                      <td className=\"xsm-text align-middle text-center\">\r\n                                                        {handleUsage(item)}\r\n                                                      </td>\r\n                                                    ) : (\r\n                                                      <td className=\"xsm-text align-middle text-center\">\r\n                                                        -\r\n                                                      </td>\r\n                                                    )}\r\n                                                  </tr>\r\n                                                );\r\n                                              } else {\r\n                                                return false;\r\n                                              }\r\n                                            })}\r\n                                          </>\r\n                                        );\r\n                                      }\r\n                                    )\r\n                                  ),\r\n                                ],\r\n                              ]\r\n                              : \"\"}\r\n                          </tbody>\r\n                        </table>\r\n                      </form>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              {/* pagination loading effect */}\r\n              {newWorkPeriod.uploading === true || loading === true\r\n                ? paginationLoading()\r\n                : [\r\n                  // logic === !searched\r\n                  !searchedWorkPeriod.searched ? (\r\n                    <div key=\"fragment4\">\r\n                      <div className=\"t-bg-white mt-1 t-pt-5 t-pb-5\">\r\n                        <div className=\"row align-items-center t-pl-15 t-pr-15\">\r\n                          <div className=\"col-md-7 t-mb-15 mb-md-0\">\r\n                            {/* pagination function */}\r\n                            {pagination(\r\n                              workPeriodList,\r\n                              setPaginatedWorkPeriod\r\n                            )}\r\n                          </div>\r\n                          <div className=\"col-md-5\">\r\n                            <ul className=\"t-list d-flex justify-content-md-end align-items-center\">\r\n                              <li className=\"t-list__item\">\r\n                                <span className=\"d-inline-block sm-text\">\r\n                                  {/* {showingData(workPeriodList)} */}\r\n                                </span>\r\n                              </li>\r\n                            </ul>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    // if searched\r\n                    <div className=\"t-bg-white mt-1 t-pt-5 t-pb-5\">\r\n                      <div className=\"row align-items-center t-pl-15 t-pr-15\">\r\n                        <div className=\"col-md-7 t-mb-15 mb-md-0\">\r\n                          <ul className=\"t-list d-flex\">\r\n                            <li className=\"t-list__item no-pagination-style\">\r\n                              <button\r\n                                className=\"btn btn-primary btn-sm\"\r\n                                onClick={() =>\r\n                                  setSearchedWorkPeriod({\r\n                                    ...searchedWorkPeriod,\r\n                                    searched: false,\r\n                                  })\r\n                                }\r\n                              >\r\n                                {_t(t(\"Clear Search\"))}\r\n                              </button>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n                        <div className=\"col-md-5\">\r\n                          <ul className=\"t-list d-flex justify-content-md-end align-items-center\">\r\n                            <li className=\"t-list__item\">\r\n                              <span className=\"d-inline-block sm-text\">\r\n                                {/* {searchedShowingData(\r\n                                    searchedWorkPeriod,\r\n                                    workPeriodForSearch\r\n                                  )} */}\r\n                              </span>\r\n                            </li>\r\n                          </ul>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ),\r\n                ]}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OpeningClosingStockIngredientReport;\r\n"]},"metadata":{},"sourceType":"module"}